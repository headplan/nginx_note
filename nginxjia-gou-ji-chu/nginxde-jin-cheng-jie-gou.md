# Nginx的进程结构

Nginx有两种进程结构 , **单进程结构**和**多进程结构** .

**单进程结构**不适用于生产环境 , 只适用于开发和调试 . 生产环境中 , 必须保证nginx足够健壮 , 并且nginx可以利用多核的特性 , 单进程结构无法满足 . 所以nginx的默认配置中都是打开为多进程结构的nginx . 配置文件 :

```
worker_processes auto;
或者
worker_processes 8; # CPU核数的2倍
```

#### Nginx的多进程模型

![](/assets/nginxduojinchengmoxing.png)

**为什么Nginx采用多进程结构 , 而不是多线程结构呢 ? **

答案是 , 为了保证Nginx的高可用性和高可靠性 . 

如果使用多线程结构的情况下 , 线程之间是共享同一个地址空间的 , 所以当某一个第三方模块引发了一个地址空间导致的段错误时 , 也就是在地址越界出现时 , 会导致整个Nginx的进程全部挂掉 . 当我们采用多进程的Nginx进程模型时 , 往往就不会出现类似的情况 . 

Nginx在做进程设计时 , 同样遵循了实现高可用和高可靠的目的 . 在master进程中 , 第三方模块通常不会在其中加入自定义的功能代码的 , 虽然这是允许的 , 但通常没有第三方模块会这样做 . master进程的目的 , 就是用来管理worker进程的 . 也就是说 , 所有的worker进程


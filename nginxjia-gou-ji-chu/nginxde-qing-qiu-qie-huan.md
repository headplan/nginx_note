# Nginx的请求切换

前面提到了Nginx是如何使用epoll来运行自己的事件驱动框架的 , 这样的事件驱动框架带来怎样的好处 ? 下面来看一下在请求切换的应用场景中 , 事件驱动框架的应用 .

![](/assets/qingqiuqiehuan.png)

在上图中 , 实际上有三个请求 , 分别是蓝色 , 绿色和橘黄色的 . 假设每个请求都是http请求 , 简化为三部分 . 比如第一部分 , 接收到HTTP请求的header , 接收到header以后 , 利用一些负载均衡算法 , 应该就知道要交给上游的哪一台服务器去处理了 . 接下来就会和上游服务器建立连接 . 或者说本地处理的时候 , 接下来会去判断header中是否有content-length , 指明它还有body体 . 如果有body的话 , 接下来的读事件会去处理HTTP body , 处理完HTTP body之后可能还会发送一个HTTP响应 , 这样一个过程中 , 经历了三个事件 . 

传统的服务 , 比如Apache , Tomcat , 每一个进程同一时间处理一个请求 .


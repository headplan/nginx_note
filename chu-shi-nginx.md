# 初识Nginx

Nginx是一个高性能的HTTP和反向代理服务器 , 主要特点是占用内存少 , 并发能力强 .

#### 基本原理

* 工作模型
* 进程解析

**工作模型**

Nginx的高性能主要是使用了epoll和kqueue网络I/O模型 .

* epoll - 使用于Linux内核2.6版本以及后的系统 , 在某些发行版中 , 如SuSE8.2 , 有让2.4版本的内核支持epoll的补丁
* kqueue - 使用于FreeBSD4.1+ , OpenBSD2.9+ , NetBSD2.0 , MacOS X

Apache使用了传统的select模型\(Apache2.4后也使用了epoll网络I/O模型\) .

Linxu下的高并发软件Squid , Memcached采用的也都是epoll网络I/O模型 .

---

#### Apache和Nginx的区别 , 或者说select模型和epoll模型的区别 .

例如 , 在菜馆中服务员接待客人 , 看成是一次请求 .

select模型服务员这样接待可以 : 客人进门 , 服务员立刻引导客人入座 , 递菜单给客人 , 等待客人点菜 . 点完菜 , 服务员到厨房下单 . 后厨做好菜后, 服务员送菜到客人的桌上 , 全程在客人桌旁招待客人 . 最后客人吃完结账 , 送客人出门 , 再继续招待下一个客人 .

epoll模型服务员 : 客人进门 , 门口的感应器告知服务员 , 服务员引导客人入座 , 菜单给客人然后去招待其他人 . 客人看了菜单 , 招呼服务员点菜 , 客人记下客人点的才 , 给后厨 , 然后继续招待其他客人 . 厨房才做好了 , 通知服务员 , 服务员上菜 , 接续做其他的 . 客人吃完饭 , 招呼服务员结账 , 然后服务员送客人出门 .

**进程解析**

正常工作的Nginx有多个进程 . 基本分为

* 主进程 - master proess
* 工作进程 - worker proess

主进程 : 充当整个进程组与用户交互的接口 , 维护并监控工作进程 . 不处理具体业务 , 只把相应的信息发送到工作进程 . 同时负责Nginx的平滑重启 , 配置文件生效 , 关闭等 .

工作进程 : 处理具体的任务 .

**主进程和工作进程的工作流程**

![](/assets/gongzuoliucheng.png)

#### Nginx的组成

**Nginx二进制可执行文件**

由各模块源码编译出的一个文件

**Nginx.conf配置文件**

控制Nginx的行为

**access.log访问日志**

记录每一条http请求信息

**error.log错误日志**

定位问题

